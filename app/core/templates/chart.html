{% extends 'base.html' %}
{% load render_table from django_tables2 %}
{% block title %}
  {% if title %}
  {{ title }}
  {% else %}
  Make Queries
  {% endif %}
{% endblock %}
{% block content %}
<ul id="querytype_nav" style="display: flex; flex-flow: row; justify-content: space-around; padding: 5px;" class="nav nav-pills nav-justified navbar-nav me-auto mb-2 mb-lg-0">
	<li class="nav-item"><a href={% url 'profit' month=currentMonth id=currentID %} class="btn btn-info" style="width:50%">Profits</a></li>
  <li class="nav-item"><a href={% url 'numsold' month=currentMonth id=currentID %} class="btn btn-info" style="width:50%">Amount Sold</a></li>
</ul>
<ul id="timeslice_nav" style="display: flex; flex-flow: row; justify-content: space-around; padding: 5px;" class="nav nav-pills nav-justified navbar-nav me-auto mb-2 mb-lg-0">
  {% if amt %}
	  <li><a href={% url 'numsold' month=3 id=currentID %} class="btn btn-info">03 Months</a></li>
    <li><a href={% url 'numsold' month=12 id=currentID %} class="btn btn-info">12 Months</a></li>
    <li><a href={% url 'numsold' month=60 id=currentID %} class="btn btn-info">60 Months</a></li>
  {% else %}
    <li><a href={% url 'profit' month=3 id=currentID %} class="btn btn-info">03 Months</a></li>
    <li><a href={% url 'profit' month=12 id=currentID %} class="btn btn-info">12 Months</a></li>
    <li><a href={% url 'profit' month=60 id=currentID %} class="btn btn-info">60 Months</a></li>
  {% endif %}
</ul>

<div style="
  display: flex;
  flex-flow: row;
">
<ul style="float : left; width : 20%; list-style-type: none;">
  {% if amt %}
    {% for product in products %}
      <li><a href={% url 'numsold' month=currentMonth id=product.id %} class="btn btn-info">{{ product.productName }}</a></li>
    {% endfor %}
  {% else %}
    {% for product in products %}
      <li><a href={% url 'profit' month=currentMonth id=product.id %} class="btn btn-info">{{ product.productName }}</a></li>
    {% endfor %}
  {% endif %}
</ul>

<div id='section2' style="display: flex; flex-flow: column; width:90%;">
<canvas id="myChart"></canvas>

<center><h3>
{% if title %}
  <p>
    {% if data %}
      {{ product.productName }}
      {% if amt %}
        {{ amt }} sold
      {% elif profit %}
        made ${{ profit }}
      {% endif %}
      in the past {{ currentMonth }} months.
    {% else %}
        There are no entries in the {{title}} Query.
    {% endif %}
  </p>
{% else %}
    <p>This is where you can see the Queries</p>
{% endif %}
</h3></center>
</div>
</div>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <script>
    const ctx = document.getElementById('myChart');

    var myChart = new Chart(ctx, {
      type: 'line',
      options: {
        scales: {
          xAxes: [{
            type: 'time',
          }],

        }
      },
      data: {
        labels: [
        {% for row in data %}
        '{{ row.t }}',
        {% endfor %}
        ],
        datasets: [{
          lineTension: 0,
          label: '{{ chartlabel }}',
          data: [
          {% for row in data %}
          { t : '{{ row.t }}', y : {{row.y}} },
          {% endfor %}
          ],
          backgroundColor: [
            //'rgba(255, 192, 192, 0.25)',
            'hsla(133, 100%, 75%, .15)',
          ],
          borderColor: [
            //'rgba(255, 192, 192,1)',
            'hsla(133, 100%, 25%, 1)',
          ],
          borderWidth: 1
        }]
      }
    });
  </script>
{% endblock %}